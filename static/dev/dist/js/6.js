(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{473:
/*!***************************************************!*\
  !*** ./src/pages/template/TemplateEdit/index.vue ***!
  \***************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(t,e,a){"use strict";a.r(e);var i=a(/*! ./index.vue?vue&type=template&id=060da313&scoped=true& */877),n=a(/*! ./index.vue?vue&type=script&lang=js& */561);for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);a(/*! ./index.vue?vue&type=style&index=0&id=060da313&lang=scss&scoped=true& */813);var s=a(/*! ../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js */2),r=Object(s.a)(n.default,i.a,i.b,!1,null,"060da313",null);r.options.__file="index.vue",e.default=r.exports},561:
/*!****************************************************************************!*\
  !*** ./src/pages/template/TemplateEdit/index.vue?vue&type=script&lang=js& ***!
  \****************************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(t,e,a){"use strict";a.r(e);var i=a(/*! -!../../../../node_modules/babel-loader/lib!../../../../node_modules/vue-loader/lib??vue-loader-options!./index.vue?vue&type=script&lang=js& */562),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);e.default=n.a},562:
/*!**************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/template/TemplateEdit/index.vue?vue&type=script&lang=js& ***!
  \**************************************************************************************************************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var i=b(a(/*! babel-runtime/core-js/object/keys */85)),n=b(a(/*! babel-runtime/regenerator */132)),o=b(a(/*! babel-runtime/helpers/asyncToGenerator */133)),s=b(a(/*! babel-runtime/core-js/object/assign */32)),r=b(a(/*! babel-runtime/helpers/extends */131));a(/*! @/utils/i18n.js */14);var l=a(/*! vuex */42),c=b(a(/*! moment */197)),u=a(/*! @/utils/uuid.js */199),d=b(a(/*! @/utils/tools.js */196)),f=b(a(/*! @/utils/atomFilter.js */534)),m=a(/*! @/utils/errorHandler.js */134),h=b(a(/*! @/components/common/PipelineCanvas/index.vue */535)),p=b(a(/*! ./NodeConfig.vue */774)),v=b(a(/*! ./GlobalVariables.vue */807)),g=b(a(/*! @/utils/draft.js */578));function b(t){return t&&t.__esModule?t:{default:t}}e.default={name:"TemplateEdit",components:{PipelineCanvas:h.default,NodeConfig:p.default,GlobalVariables:v.default},props:["cc_id","template_id","type"],data:function(){return{i18n:{leave:gettext("离开页面"),tips:gettext("系统可能不会保存您所做的更改，确认离开？")},bkMessageInstance:null,exception:{},singleAtomListLoading:!1,subAtomListLoading:!1,businessInfoLoading:!1,templateDataLoading:!1,templateSaving:!1,isTemplateConfigValid:!0,isTemplateDataChanged:!1,isSettingPanelShow:!0,isNodeConfigPanelShow:!1,isLeaveDialogShow:!1,allowLeave:!1,leaveToPath:"",idOfNodeInConfigPanel:"",subAtomGrouped:[],draftArray:[],intervalSaveTemplate:null,intervalGetDraftArray:null,templateUUID:(0,u.uuid)()}},computed:(0,r.default)({},(0,l.mapState)({singleAtom:function(t){return t.atomList.singleAtom},subAtom:function(t){return t.atomList.subAtom},searchAtomResult:function(t){return t.atomList.searchAtomResult},atomConfig:function(t){return t.atomForm.config},name:function(t){return t.template.name},activities:function(t){return t.template.activities},locations:function(t){return t.template.location},lines:function(t){return t.template.line},constants:function(t){return t.template.constants},gateways:function(t){return t.template.gateways},businessBaseInfo:function(t){return t.template.businessBaseInfo},category:function(t){return t.template.category},subprocess_info:function(t){return t.template.subprocess_info},username:function(t){return t.username}}),(0,l.mapGetters)("atomList/",["singleAtomGrouped"]),{atomTypeList:function(){var t=this,e=d.default.deepClone(this.subAtomGrouped);if("new"!==this.type){var a=void 0;this.subAtomGrouped.some(function(i,n){var o=i.list.some(function(e,i){if(e.id===Number(t.template_id))return a=i,!0});return o&&e[n].list.splice(a,1),o})}return{tasknode:this.singleAtomGrouped,subflow:e}},canvasData:function(){var t=this,e={};for(var a in this.gateways){var i=this.gateways[a];i.conditions&&(e[i.id]=(0,s.default)({},i.conditions))}return{activities:this.activities,lines:this.lines,locations:this.locations.map(function(e){var a=(0,r.default)({},e,{mode:"edit"});return t.subprocess_info&&t.subprocess_info.details&&"subflow"===e.type&&t.subprocess_info.details.some(function(t){if(t.subprocess_node_id===e.id&&t.expired)return a.hasUpdated=!0,!0}),a}),branchConditions:e}}}),created:function(){this.initTemplateData()},mounted:function(){var t=this;if(this.getSingleAtomList(),this.getBusinessBaseInfo(),"edit"===this.type||"clone"===this.type)this.getTemplateData();else{var e="new"+(0,c.default)().format("YYYYMMDDHHmmss");this.setTemplateName(e)}"clone"===this.type?(g.default.copyAndReplaceDraft(this.username,this.cc_id,this.template_id,this.templateUUID),this.draftArray=g.default.getDraftArray(this.username,this.cc_id,this.templateUUID)):this.draftArray=g.default.getDraftArray(this.username,this.cc_id,this.getTemplateIdOrTemplateUUID()),this.intervalSaveTemplate=setInterval(function(){g.default.addDraft(t.username,t.cc_id,t.getTemplateIdOrTemplateUUID(),t.getLocalTemplateData())},3e5),this.intervalGetDraftArray=setInterval(function(){t.draftArray=g.default.getDraftArray(t.username,t.cc_id,t.getTemplateIdOrTemplateUUID())},305e3)},beforeDestroy:function(){this.resetTemplateData()},methods:(0,r.default)({},(0,l.mapActions)("atomList/",["loadSingleAtomList","loadSubAtomList"]),(0,l.mapActions)("template/",["loadBusinessBaseInfo","loadTemplateData","saveTemplateData"]),(0,l.mapActions)("atomForm/",["loadAtomConfig","loadSubflowConfig"]),(0,l.mapMutations)("atomList/",["setSingleAtom","setSubAtom","searchAtom"]),(0,l.mapMutations)("template/",["initTemplateData","resetTemplateData","setBusinessBaseInfo","setTemplateName","setTemplateData","setLocation","setLocationXY","setLine","setActivities","setGateways","setStartpoint","setEndpoint","setBranchCondition","replaceTemplate","replaceLineAndLocation"]),(0,l.mapMutations)("atomForm/",["setAtomConfig"]),(0,l.mapGetters)("template/",["getLocalTemplateData"]),{getSingleAtomList:function(){var t=this;return(0,o.default)(n.default.mark(function e(){var a;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.singleAtomListLoading=!0,e.prev=1,e.next=4,t.loadSingleAtomList();case 4:a=e.sent,t.setSingleAtom(a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),(0,m.errorHandler)(e.t0,t);case 11:return e.prev=11,t.singleAtomListLoading=!1,e.finish(11);case 14:case"end":return e.stop()}},e,t,[[1,8,11,14]])}))()},getBusinessBaseInfo:function(){var t=this;return(0,o.default)(n.default.mark(function e(){var a;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.businessInfoLoading=!0,e.prev=1,e.next=4,t.loadBusinessBaseInfo();case 4:a=e.sent,t.setBusinessBaseInfo(a),t.getSubAtomList(t.cc_id),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),(0,m.errorHandler)(e.t0,t);case 12:return e.prev=12,t.businessInfoLoading=!1,e.finish(12);case 15:case"end":return e.stop()}},e,t,[[1,9,12,15]])}))()},getSubAtomList:function(t){var e=this;return(0,o.default)(n.default.mark(function a(){var i;return n.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e.subAtomListLoading=!0,a.prev=1,a.next=4,e.loadSubAtomList(t);case 4:i=a.sent,e.setSubAtom(i),e.handleSubflowGroup(),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(1),(0,m.errorHandler)(a.t0,e);case 12:return a.prev=12,e.subAtomListLoading=!1,a.finish(12);case 15:case"end":return a.stop()}},a,e,[[1,9,12,15]])}))()},getTemplateData:function(){var t=this;return(0,o.default)(n.default.mark(function e(){var a;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.templateDataLoading=!0,e.prev=1,e.next=4,t.loadTemplateData(t.template_id);case 4:a=e.sent,"clone"===t.type&&(a.name=a.name.slice(0,24)+"_clone"),t.setTemplateData(a),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),(0,m.errorHandler)(e.t0,t);case 12:return e.prev=12,t.templateDataLoading=!1,e.finish(12);case 15:case"end":return e.stop()}},e,t,[[1,9,12,15]])}))()},getSingleAtomConfig:function(e){var a=this;return(0,o.default)(n.default.mark(function i(){var o;return n.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(o=e.atomId,!t.atoms[o]){i.next=4;break}return a.addSingleAtomActivities(e,t.atoms[o]),i.abrupt("return");case 4:return a.atomConfigLoading=!0,i.prev=5,i.next=8,a.loadAtomConfig({atomType:o});case 8:a.setAtomConfig({atomType:o,configData:t.atoms[o]}),a.addSingleAtomActivities(e,t.atoms[o]),i.next=15;break;case 12:i.prev=12,i.t0=i.catch(5),(0,m.errorHandler)(i.t0,a);case 15:return i.prev=15,a.atomConfigLoading=!1,i.finish(15);case 18:case"end":return i.stop()}},i,a,[[5,12,15,18]])}))()},getSubflowConfig:function(t){var e=this;return(0,o.default)(n.default.mark(function a(){var i,o,s;return n.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.loadSubflowConfig({id:t.atomId});case 3:i=a.sent,o=d.default.deepClone(i.form),(s=d.default.deepClone(e.activities[t.id])).constants=o||{},e.setActivities({type:"edit",location:s}),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(0),(0,m.errorHandler)(a.t0,e);case 13:case"end":return a.stop()}},a,e,[[0,10]])}))()},saveTemplate:function(t){var e=this;return(0,o.default)(n.default.mark(function a(){var i,o;return n.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e.templateSaving=!0,i="edit"===e.type?e.template_id:void 0,a.prev=2,a.next=5,e.saveTemplateData({template_id:i,cc_id:e.cc_id});case 5:o=a.sent,void 0===i&&g.default.draftReplace(e.username,e.cc_id,o.template_id,e.templateUUID),t&&e.$bkMessage({message:gettext("保存成功"),theme:"success"}),e.isTemplateDataChanged=!1,"edit"!==e.type&&(e.allowLeave=!0,e.$router.push({path:"/template/edit/"+e.cc_id+"/",query:{template_id:o.template_id}})),a.next=15;break;case 12:a.prev=12,a.t0=a.catch(2),(0,m.errorHandler)(a.t0,e);case 15:return a.prev=15,e.templateSaving=!1,a.finish(15);case 18:case"end":return a.stop()}},a,e,[[2,12,15,18]])}))()},addSingleAtomActivities:function(t,e){var a={},i=f.default.getFormItemDefaultValue(e);e.forEach(function(t){a[t.tag_code]={hook:!1,value:i[t.tag_code]}});var n=d.default.deepClone(this.activities[t.id]);n.component.data=a,this.setActivities({type:"edit",location:n})},handleSubflowGroup:function(){var t=this.subAtom,e=[],a=[];this.businessBaseInfo.task_categories.forEach(function(t){e.push(t.value),a.push({type:t.value,group_name:t.name,group_icon:"",list:[]})}),t.forEach(function(t){var i=t.category,n=e.indexOf(i);n>-1&&a[n].list.push(t)}),this.subAtomGrouped=a},toggleSettingPanel:function(t){this.isSettingPanelShow=t},showConfigPanel:function(t){this.varibleDataChanged(),this.isNodeConfigPanelShow=!0,this.idOfNodeInConfigPanel=t},hideConfigPanel:function(){this.idOfNodeInConfigPanel&&this.onUpdateNodeInfo(this.idOfNodeInConfigPanel,{isActived:!1}),this.isNodeConfigPanelShow=!1,this.idOfNodeInConfigPanel=""},varibleDataChanged:function(){this.isTemplateDataChanged=!0},validateAtomNode:function(){var t=this,e=!0;return(0,i.default)(this.activities).forEach(function(a){var i=!0,n=t.activities[a];"ServiceActivity"===n.type&&(n.name||(i=!1),n.component.code&&t.validateAtomInputForm(n.component)||(i=!1)),i||(e=!1,t.markInvalidNode(a))}),e||this.$bkMessage({message:gettext("任务节点参数错误，请点击错误节点查看详情"),theme:"error"}),e},validateAtomInputForm:function(t){var e=t.code,a=t.data,i=this.atomConfig[e];return!!a&&(!i||this.checkAtomData(i,a))},checkAtomData:function(t,e){var a=this,i=!0;return t.forEach(function(t){var n=t.tag_code,o=t.type,s=t.attrs,r=e[n]&&e[n].value;"combine"===o?a.checkAtomData(s.children,r)||(i=!1):s.validation&&s.validation.length&&s.validation.forEach(function(t){"required"===t.type&&d.default.isEmpty(r)&&(i=!1),"regex"===t.type&&(new RegExp(t.args).test(r)||(i=!1)),"custom"===t.type&&(/^\${[^${}]+}$/.test(r)||t.args.call(a,r).result||(i=!1))})}),i},markInvalidNode:function(t){this.onUpdateNodeInfo(t,{status:"FAILED"})},onSearchAtom:function(t){var e=(0,r.default)({},t,{exclude:"new"!==this.type?[Number(this.template_id)]:[]});this.searchAtom(e)},onNodeClick:function(t){var e=this,a=this.idOfNodeInConfigPanel,i=this.locations.filter(function(e){return e.id===t})[0].type;"tasknode"!==i&&"subflow"!==i||(a&&this.onUpdateNodeInfo(a,{isActived:!1}),this.onUpdateNodeInfo(t,{isActived:!0}),this.isNodeConfigPanelShow?this.$refs.nodeConfig.syncNodeDataToActivities().then(function(a){e.showConfigPanel(t)}):this.showConfigPanel(t))},onLabelBlur:function(t){this.varibleDataChanged(),this.setBranchCondition(t)},onLocationChange:function(t,e){switch(this.setLocation({type:t,location:e}),e.type){case"tasknode":if("add"===t&&e.atomId)return this.setActivities({type:"add",location:e}),void this.getSingleAtomConfig(e);"delete"===t&&this.hideConfigPanel(),this.setActivities({type:t,location:e});break;case"subflow":if("add"===t&&e.atomId)return this.setActivities({type:"add",location:e}),void this.getSubflowConfig(e);"delete"===t&&this.hideConfigPanel(),this.setActivities({type:t,location:e});break;case"branchgateway":case"parallelgateway":case"convergegateway":this.setGateways({type:t,location:e});break;case"startpoint":this.setStartpoint({type:t,location:e});break;case"endpoint":this.setEndpoint({type:t,location:e})}},onLineChange:function(t,e){this.setLine({type:t,line:e})},onLocationMoveDone:function(t){this.varibleDataChanged(),this.setLocationXY(t)},onUpdateNodeInfo:function(t,e){this.$refs.pipelineCanvas.onUpdateNodeInfo(t,e)},onDeleteConstant:function(t){if(this.varibleDataChanged(),this.isNodeConfigPanelShow){var e=this.constants[t];this.$refs.nodeConfig.onDeleteConstant(e)}},onChangeName:function(t){this.varibleDataChanged(),this.setTemplateName(t)},onSelectCategory:function(t){t&&(this.isTemplateConfigValid=!0)},onSaveTemplate:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.templateSaving)return this.category?void(this.isNodeConfigPanelShow?this.$refs.nodeConfig.syncNodeDataToActivities().then(function(a){a&&t.onCheckNodeAndSaveTemplate(e)}):this.onCheckNodeAndSaveTemplate(e)):(this.isTemplateConfigValid=!1,void(this.isSettingPanelShow=!0))},onCheckNodeAndSaveTemplate:function(t){var e=document.querySelectorAll(".node-with-text.FAILED");if(e&&e.length)return this.templateSaving=!1,void(0,m.errorHandler)({message:gettext("任务节点参数错误，请点击错误节点查看详情")},this);this.validateAtomNode()&&this.saveTemplate(t)},onBackToList:function(){this.$router.push({path:"/template/home/"+this.cc_id+"/"})},onLeaveConfirm:function(){this.allowLeave=!0,this.$router.push({path:this.leaveToPath})},onLeaveCancel:function(){this.allowLeave=!1,this.leaveToPath="",this.isLeaveDialogShow=!1},onDeleteDraft:function(t){g.default.deleteDraft(t)?this.$bkMessage({message:gettext("删除草稿成功"),theme:"success"}):this.$bkMessage({message:gettext("该草稿不存在，删除失败"),theme:"error"}),this.draftArray=g.default.getDraftArray(this.username,this.cc_id,this.getTemplateIdOrTemplateUUID())},onReplaceTemplate:function(t){var e=this;this.templateDataLoading=!0,g.default.addDraft(this.username,this.cc_id,this.getTemplateIdOrTemplateUUID(),this.getLocalTemplateData(),gettext("替换模板自动保存")),this.replaceTemplate(t),this.draftArray=g.default.getDraftArray(this.username,this.cc_id,this.getTemplateIdOrTemplateUUID()),this.$bkMessage({message:gettext("替换模板草稿成功"),theme:"success"}),this.$nextTick(function(){e.templateDataLoading=!1})},onNewDraft:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];"clone"===this.type?(g.default.addDraft(this.username,this.cc_id,this.templateUUID,this.getLocalTemplateData(),t),this.draftArray=g.default.getDraftArray(this.username,this.cc_id,this.templateUUID)):(g.default.addDraft(this.username,this.cc_id,this.getTemplateIdOrTemplateUUID(),this.getLocalTemplateData(),t),this.draftArray=g.default.getDraftArray(this.username,this.cc_id,this.getTemplateIdOrTemplateUUID())),e&&this.$bkMessage({message:gettext("新增模板草稿成功"),theme:"success"})},onReplaceLineAndLocation:function(t){this.replaceLineAndLocation(t)},getTemplateIdOrTemplateUUID:function(){return void 0===this.template_id||""===this.template_id?this.templateUUID:this.template_id}}),beforeRouteLeave:function(t,e,a){this.allowLeave||!this.isTemplateDataChanged?(clearInterval(this.intervalSaveTemplate),clearInterval(this.intervalGetDraftArray),28!==this.getTemplateIdOrTemplateUUID().length&&"clone"!==this.type||g.default.deleteAllDraftByUUID(this.username,this.cc_id,this.templateUUID),a()):(this.leaveToPath=t.path,this.isLeaveDialogShow=!0)}}}).call(this,a(/*! jquery */24))},580:
/*!*********************************************************************************!*\
  !*** ./src/pages/template/TemplateEdit/NodeConfig.vue?vue&type=script&lang=js& ***!
  \*********************************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(t,e,a){"use strict";a.r(e);var i=a(/*! -!../../../../node_modules/babel-loader/lib!../../../../node_modules/vue-loader/lib??vue-loader-options!./NodeConfig.vue?vue&type=script&lang=js& */581),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);e.default=n.a},581:
/*!*******************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/template/TemplateEdit/NodeConfig.vue?vue&type=script&lang=js& ***!
  \*******************************************************************************************************************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var i=k(a(/*! babel-runtime/core-js/object/assign */32)),n=k(a(/*! babel-runtime/helpers/defineProperty */200)),o=k(a(/*! babel-runtime/core-js/object/keys */85)),s=k(a(/*! babel-runtime/helpers/slicedToArray */468)),r=k(a(/*! babel-runtime/core-js/get-iterator */136)),l=k(a(/*! babel-runtime/regenerator */132)),c=k(a(/*! babel-runtime/helpers/asyncToGenerator */133)),u=k(a(/*! babel-runtime/helpers/extends */131));a(/*! @/utils/i18n.js */14);var d=a(/*! vuex */42),f=a(/*! @/utils/errorHandler.js */134),m=a(/*! @/utils/checkDataType.js */135),h=k(a(/*! @/utils/tools.js */196)),p=k(a(/*! @/utils/dom.js */570)),v=k(a(/*! @/utils/atomFilter.js */534)),g=a(/*! @/utils/uuid.js */199),b=a(/*! @/constants/index.js */502),C=k(a(/*! @/components/common/base/NoData.vue */496)),_=k(a(/*! @/components/common/RenderFormNew/RenderForm.vue */514)),y=k(a(/*! @/components/common/base/BaseCheckbox.vue */515)),D=k(a(/*! @/components/common/base/BaseInput.vue */509)),w=k(a(/*! ./ReuseVarDialog.vue */804));function k(t){return t&&t.__esModule?t:{default:t}}var x=/^\$\{(\w+)\}$/;e.default={name:"NodeConfig",components:{NoData:C.default,RenderForm:_.default,BaseCheckbox:y.default,BaseInput:D.default,ReuseVarDialog:w.default},props:["isNodeConfigPanelShow","isSettingPanelShow","singleAtom","subAtom","idOfNodeInConfigPanel","template_id"],data:function(){return{i18n:{base_info:gettext("基础信息"),flow:gettext("流程模板"),node_name:gettext("节点名称"),stage_tag:gettext("步骤名称"),ignore:gettext("忽略错误"),optional:gettext("是否可选"),input:gettext("输入参数"),output:gettext("输出参数"),name:gettext("名称"),refer:gettext("引用"),hook:gettext("勾选参数作为全局变量"),cancelHook:gettext("取消勾选"),typeEmptyTip:gettext("不能为空"),update:gettext("版本更新")},atomConfigLoading:!1,errorCouldBeIgnored:!1,nodeCouldBeSkipped:!1,subflowHasUpdate:!1,bkMessageInstance:null,subAtomConfigData:null,nodeConfigData:null,reuseVariable:{},isReuseVarDialogShow:!1,taskTypeEmpty:!1,reuseableVarList:[],nodeId:this.idOfNodeInConfigPanel,nodeName:"",stageName:gettext("步骤1"),currentAtom:"",subAtomInput:[],subAtomOutput:[],renderInputOption:{showGroup:!1,showHook:!0,showLabel:!0},inputAtomHook:{},inputAtomData:void 0,nodeNameRule:{required:!0,max:50,regex:b.NAME_REG},stageNameRule:{max:50,regex:b.NAME_REG},isAtomChanged:!1}},computed:(0,u.default)({},(0,d.mapState)({activities:function(t){return t.template.activities},constants:function(t){return t.template.constants},atomForm:function(t){return t.atomForm.form},atomFormConfig:function(t){return t.atomForm.config},atomFormOutput:function(t){return t.atomForm.output},subprocessInfo:function(t){return t.template.subprocess_info}}),{atomList:function(){var t=this;return this.isSingleAtom?this.singleAtom.map(function(t){return{id:t.code,name:t.group_name+"-"+t.name}}):this.subAtom.filter(function(e){return e.template_id!==Number(t.template_id)}).map(function(t){return{id:t.template_id,name:t.name}})},atomDesc:function(){return this.singleAtom?this.atomForm[this.currentAtom]&&this.atomForm[this.currentAtom].desc:""},isSingleAtom:function(){return this.nodeConfigData&&"ServiceActivity"===this.nodeConfigData.type},atomNameType:function(){return this.isSingleAtom?gettext("原子类型"):gettext("流程模板")},renderOutputData:function(){var t=this,e=[],a=this.getOutputConfig();return a&&a.forEach(function(a){var i=!1,n=a.key;for(var o in t.constants)"component_outputs"===t.constants[o].source_type&&t.constants[o].source_info[t.nodeId]&&t.constants[o].source_info[t.nodeId].indexOf(n)>-1&&(i=!0,n=o);e.push({name:a.name,key:n,hook:i})}),e},renderInputConfig:function(){return this.isSingleAtom?this.getSingleAtomConfig():this.subAtomInput},renderInputData:function(){return{hook:this.inputAtomHook,value:this.inputAtomData}}}),created:function(){this.initData()},mounted:function(){window.addEventListener("click",this.handleNodeConfigPanelShow,!1)},beforeDestroy:function(){window.removeEventListener("click",this.handleNodeConfigPanelShow,!1)},watch:{idOfNodeInConfigPanel:function(t){this.nodeId=t,this.initData()}},methods:(0,u.default)({},(0,d.mapMutations)("atomForm/",["setAtomConfig"]),(0,d.mapMutations)("template/",["addVariable","deleteVariable","setActivities","setVariableSourceInfo","setSubprocessUpdated"]),(0,d.mapActions)("atomForm/",["loadAtomConfig","loadSubflowConfig"]),{initData:function(){this.nodeConfigData=h.default.deepClone(this.activities[this.nodeId]),this.getNodeFormData(),this.getConfig(this.nodeConfigData.version)},getConfig:function(t){if(""!==this.currentAtom&&void 0!==this.currentAtom)return this.isSingleAtom?this.getAtomConfig(this.currentAtom):this.getSubflowConfig(this.currentAtom,t);this.markInvalidForm()},getAtomConfig:function(e){var a=this;return(0,c.default)(l.default.mark(function i(){return l.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!t.atoms[e]){i.next=3;break}return a.setNodeConfigData(e),i.abrupt("return");case 3:return a.atomConfigLoading=!0,i.prev=4,i.next=7,a.loadAtomConfig({atomType:e});case 7:a.setAtomConfig({atomType:e,configData:t.atoms[e]}),a.setNodeConfigData(e),i.next=14;break;case 11:i.prev=11,i.t0=i.catch(4),(0,f.errorHandler)(i.t0,a);case 14:return i.prev=14,a.atomConfigLoading=!1,a.isAtomChanged=!0,i.finish(14);case 18:case"end":return i.stop()}},i,a,[[4,11,14,18]])}))()},getSubflowConfig:function(e,a){var i=this;return(0,c.default)(l.default.mark(function n(){var o,c,u,d,p,g,b,C,_,y,D,w,k,x,A,S,N,I,V,E,T,L,$,R;return l.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i.atomConfigLoading=!0,i.nodeConfigData.template_id=e,i.currentAtom,i.nodeConfigData.template_id,n.prev=3,n.next=6,i.loadSubflowConfig({id:e,version:a});case 6:for(d in i.subAtomConfigData=n.sent,i.nodeConfigData.version=i.subAtomConfigData.version,o=[],c=[],u=[],i.nodeConfigData.version=i.subAtomConfigData.version,i.subprocessInfo&&i.subprocessInfo.details&&i.subprocessInfo.details.some(function(t){t.expired&&t.template_id===Number(i.currentAtom)&&t.subprocess_node_id===i.nodeId&&(i.subflowHasUpdate=!0)}),i.subAtomConfigData.form)"show"===(p=h.default.deepClone(i.subAtomConfigData.form[d])).show_type&&u.push(p);u=u.sort(function(t,e){return t.index-e.index}),g=!0,b=!1,C=void 0,n.prev=18,_=(0,r.default)(u);case 20:if(g=(y=_.next()).done){n.next=47;break}if(D=y.value,w=D.key,k={},!(x=D.source_tag)){n.next=39;break}if(A=x.split("."),S=(0,s.default)(A,2),N=S[0],I=S[1],i.atomFormConfig[N]){n.next=31;break}return n.next=30,i.loadAtomConfig({atomType:N});case 30:i.setAtomConfig({atomType:N,configData:t.atoms[N]});case 31:V=i.atomFormConfig[N],E=h.default.deepClone(v.default.formFilter(I,V)),(D.is_meta||E.meta_transform)&&(E=E.meta_transform(D.meta||D),D.meta||(D.value=E.attrs.value)),E.tag_code=w,E.attrs.name=i.subAtomConfigData.form[w].name,o.push(E),n.next=42;break;case 39:T={tag_code:w,type:D.custom_type,variableKey:w,attrs:{name:D.name,hookable:!0}},D.validation&&"String"===(0,m.checkDataType)(D.validation)&&(L={type:"regex",args:D.validation,error_message:gettext("输入值不满足校验规则")+D.validation},T.attrs.validation=[L]),o.push(T);case 42:k=i.activities[i.nodeId].constants[w]||D,i.$set(i.nodeConfigData.constants,w,h.default.deepClone(k));case 44:g=!0,n.next=20;break;case 47:n.next=53;break;case 49:n.prev=49,n.t0=n.catch(18),b=!0,C=n.t0;case 53:n.prev=53,n.prev=54,!g&&_.return&&_.return();case 56:if(n.prev=56,!b){n.next=59;break}throw C;case 59:return n.finish(56);case 60:return n.finish(53);case 61:for(w in i.subAtomConfigData.outputs)$=i.subAtomConfigData.outputs[w],R={key:w,name:$.name},c.push(R);i.subAtomInput=o,i.subAtomOutput=c,i.getNodeFormData(),i.$nextTick(function(){i.updateActivities(),i.markInvalidForm()}),n.next=71;break;case 68:n.prev=68,n.t1=n.catch(3),(0,f.errorHandler)(n.t1,i);case 71:return n.prev=71,i.atomConfigLoading=!1,n.finish(71);case 74:case"end":return n.stop()}},n,i,[[3,68,71,74],[18,49,53,61],[54,,56,60]])}))()},setNodeConfigData:function(t){var e=this,a={},i=this.atomFormConfig[t];t===this.activities[this.nodeId].component.code?this.nodeConfigData=h.default.deepClone(this.activities[this.nodeId]):(i.forEach(function(t){a[t.tag_code]={hook:!1}}),this.$set(this.nodeConfigData,"component",{code:t,data:a})),this.getNodeFormData(),this.$nextTick(function(){e.updateActivities(),e.markInvalidForm()})},getNodeFormData:function(){var t=this,e=h.default.deepClone(this.nodeConfigData);this.nodeName=e.name,this.stageName=e.stage_name,this.nodeCouldBeSkipped=e.optional;var a={},i={};if(this.isSingleAtom){var n=h.default.deepClone(e.component.data);for(var o in this.currentAtom=e.component.code||"",this.errorCouldBeIgnored=e.error_ignorable,n)a[o]=n[o].hook,"value"in n[o]&&(i[o]=h.default.deepClone(n[o].value))}else{this.currentAtom=e.template_id;var s=function(n){var o=e.constants[n],s=n.match(x)[1];t.subAtomInput.filter(function(t){return t.variableKey===n})[0],o.hook=t.iskeyInSourceInfo(n,s),a[n]=o.hook,"value"in o&&(i[n]=h.default.deepClone(o.value))};for(var r in e.constants)s(r)}this.inputAtomHook=a,this.inputAtomData=i},getSingleAtomConfig:function(){var t=this.atomFormConfig[this.currentAtom];return t?t.map(function(t){return(0,u.default)({variableKey:t.tag_code},t)}):{}},getOutputConfig:function(){return this.isSingleAtom?this.atomFormOutput[this.currentAtom]:this.subAtomOutput},getHookedInputVariables:function(){var t=[];for(var e in this.renderInputData.hook)if(this.renderInputData.hook[e]){var a=this.inputAtomData[e];t.push({variableKey:a,formKey:e,id:this.nodeId,tagCode:x.test(e)?e.match(x)[1]:e})}return t},iskeyInSourceInfo:function(t,e){for(var a in this.constants){var i=this.constants[a],n=i.source_info[this.nodeId];if("component_inputs"===i.source_type&&n&&(n.indexOf(e)>-1||n.indexOf(t)>-1))return!0}return!1},handleNodeConfigPanelShow:function(t){if(this.isNodeConfigPanelShow&&!this.isReuseVarDialogShow){var e=document.querySelector(".setting-panel"),a=document.querySelector(".node-config");e&&a&&(p.default.nodeContains(e,t.target)||p.default.nodeContains(a,t.target)||this.syncNodeDataToActivities())}},syncNodeDataToActivities:function(){return this.updateActivities(),this.updateNodeInfo()},updateActivities:function(){var t=h.default.deepClone(this.nodeConfigData);if(t.name=this.nodeName,t.stage_name=this.stageName,t.optional=this.nodeCouldBeSkipped,this.isSingleAtom)for(var e in t.error_ignorable=this.errorCouldBeIgnored,this.inputAtomData)t.component.data[e]={hook:this.inputAtomHook[e],value:h.default.deepClone(this.inputAtomData[e])};else{var a=h.default.deepClone(this.subAtomConfigData.form);for(var i in this.inputAtomData)a[i]&&(a[i].value=h.default.deepClone(this.inputAtomData[i]));t.constants=a}this.setActivities({type:"edit",location:t})},updateNodeInfo:function(){var t=this,e=!0;return this.$validator.validateAll().then(function(a){var i="",n=!0;return t.currentAtom||(t.taskTypeEmpty=!0),t.$refs.renderForm&&(n=t.$refs.renderForm.validate()),t.currentAtom&&a&&n||(e=!1,i="FAILED"),t.$emit("onUpdateNodeInfo",t.nodeId,{status:i,name:t.nodeName,stage_name:t.stageName,optional:t.nodeCouldBeSkipped,error_ignorable:t.errorCouldBeIgnored}),t.$emit("hideConfigPanel"),e})},markInvalidForm:function(){var t=document.querySelector("#"+this.nodeId).querySelector(".node-with-text");t&&!this.isAtomChanged&&"FAILED"===t.dataset.status&&(this.$validator.validateAll(),this.$refs.renderForm&&this.$refs.renderForm.validate(),this.currentAtom||(this.taskTypeEmpty=!0))},clearHookedVaribles:function(){var t=this;this.getHookedInputVariables().forEach(function(e){var a=e.id,i=e.variableKey,n=e.formKey,s=(e.tagCode,t.constants[i]);t.setVariableSourceInfo({type:"delete",id:a,key:i,tagCode:n}),s&&!(0,o.default)(s.source_info).length&&t.deleteVariable(i)}),this.taskTypeEmpty=!1,this.renderOutputData.forEach(function(e){e.hook&&t.deleteVariable(e.key)})},onAtomSelect:function(t,e){var a=this;this.isAtomChanged=!0;var i=void 0;this.clearHookedVaribles(),this.currentAtom=t,this.isSingleAtom?i=e.name.split("-").slice(1).join().replace(/\s/g,""):(this.$emit("onUpdateNodeInfo",this.idOfNodeInConfigPanel,{hasUpdated:!1}),this.subflowHasUpdate=!1,this.setSubprocessUpdated({template_id:Number(this.currentAtom),subprocess_node_id:this.idOfNodeInConfigPanel}),i=e.name.replace(/\s/g,""),this.subAtomConfigData.form={},this.inputAtomHook={},this.inputAtomData={}),this.nodeConfigData.name=i,this.updateActivities(),this.getConfig(),this.$nextTick(function(){a.isAtomChanged=!1})},onUpdateSubflowVersion:function(){var t=this;this.clearHookedVaribles(),this.subAtomConfigData.form={},this.inputAtomHook={},this.inputAtomData={},this.updateActivities(),this.getSubflowConfig(this.currentAtom).then(function(){t.subflowHasUpdate=!1,t.$emit("onUpdateNodeInfo",t.idOfNodeInConfigPanel,{hasUpdated:!1}),t.setSubprocessUpdated({template_id:Number(t.currentAtom),subprocess_node_id:t.idOfNodeInConfigPanel,version:t.subAtomConfigData.version})})},onErrorIngoredChange:function(t){this.errorCouldBeIgnored=t},onSkippedChange:function(t){this.nodeCouldBeSkipped=t},onInputDataChange:function(t){this.inputAtomData=t},onInputHookChange:function(t,e){var a,i=void 0,s=void 0,r=void 0,l=void 0,c=void 0,u=void 0,d=/^\$\{[\w]*\}$/.test(t)?t:"${"+t+"}",f=this.renderInputConfig.filter(function(e){return e.tag_code===t})[0];if(a=f.attrs.name.replace(/\s/g,""),this.isSingleAtom)i=t,s=this.nodeConfigData.component.code+"."+t,r=(0,n.default)({},this.nodeId,[t]),l="",c=h.default.deepClone(this.inputAtomData[t]);else{var m=this.subAtomConfigData.form[d];i=d,r=(0,n.default)({},this.nodeId,[d]),l=m.custom_type,c=h.default.deepClone(this.inputAtomData[i]),"combine"===f.type?s=m.source_tag.split(".")[0]+"."+d:(s=m.source_tag,u=m.validation)}if(this.$set(this.inputAtomHook,i,e),e){var p=[];if(!s){var v={name:a,key:d,source_info:r,custom_type:l,value:c,validation:u};return this.$set(this.inputAtomData,i,d),void this.createVariable(v)}for(var g in this.constants){var b=this.constants[g],C=b.source_tag;C&&C.split(".")[1]===t&&p.push({name:b.name+"("+b.key+")",id:b.key})}var _=d in this.constants;if(p.length)this.reuseVariable={name:a,key:i,source_tag:s,source_info:r,value:c,useNewKey:!1},this.reuseableVarList=p,this.isReuseVarDialogShow=!0;else{if(!_){var y={name:a,key:d,source_tag:s,source_info:r,custom_type:l,value:c};return this.$set(this.inputAtomData,i,d),void this.createVariable(y)}this.reuseVariable={name:a,key:i,source_tag:s,source_info:r,value:c,useNewKey:!0},this.reuseableVarList=p,this.isReuseVarDialogShow=!0}}else{d=this.inputAtomData[i];var D=this.constants[d],w=this.isSingleAtom?t:i;this.inputAtomHook[w]=e,this.inputAtomData[w]=h.default.deepClone(this.constants[d].value),this.setVariableSourceInfo({type:"delete",id:this.nodeId,key:d,tagCode:w}),D&&!(0,o.default)(D.source_info).length&&this.deleteVariable(d)}},onOutputHookChange:function(t,e,a){var i=this;if(a){var o=this.generateRandomKey(e),s={name:t,key:o,source_type:"component_outputs",source_info:(0,n.default)({},this.nodeId,[e]),source_tag:"",custom_type:"",show_type:"hide"};this.renderOutputData.some(function(t){if(t.key===e)return i.$set(t,"key",o),!0}),this.createVariable(s)}else this.constants[e]&&this.deleteVariable(e)},createVariable:function(t){var e={name:"",key:"",desc:"",custom_type:"",source_info:{},source_tag:"",value:"",show_type:"show",source_type:"component_inputs",validation:"",index:(0,o.default)(this.constants).length},a=(0,i.default)({},e,t);this.addVariable((0,i.default)({},a))},generateRandomKey:function(t){var e=t.replace(/^\$\{/,"").replace(/(\}$)/,"").slice(0,14);do{e="${"+e+"_"+(0,g.random4)()+"}"}while(this.constants[e]);return e},onConfirmReuseVar:function(t){var e=t.type,a=t.name,i=t.key,n=t.varKey,o=t.source_tag,s=t.source_info,r=t.value;if("create"===e){if(this.constants[n])return void this.$bkMessage({message:gettext("变量KEY已存在"),theme:"error"});this.$set(this.inputAtomHook,n,!0),this.$set(this.inputAtomData,i,n);var l={name:a,key:n,source_tag:o,source_info:s,value:r};this.createVariable(l)}else this.$set(this.inputAtomHook,n,!0),this.$set(this.inputAtomData,i,n),this.setVariableSourceInfo({type:"add",id:this.nodeId,key:n,tagCode:i,value:r});this.isReuseVarDialogShow=!1},onCancelReuseVar:function(t){var e=t.key;this.inputAtomHook[e]=!1,this.isReuseVarDialogShow=!1},onDeleteConstant:function(t){var e=this,a=t.source_info,i=t.source_type,n=t.value;if(t.key,"component_inputs"===i){var o=a[this.nodeId];o&&o.forEach(function(t){var a=t;e.isSingleAtom||(a=x.test(t)?t:"${"+t+"}"),e.inputAtomHook[a]=!1,e.inputAtomData[a]=h.default.deepClone(n)})}}})}}).call(this,a(/*! jquery */24))},629:
/*!*************************************************************************************!*\
  !*** ./src/pages/template/TemplateEdit/ReuseVarDialog.vue?vue&type=script&lang=js& ***!
  \*************************************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(t,e,a){"use strict";a.r(e);var i=a(/*! -!../../../../node_modules/babel-loader/lib!../../../../node_modules/vue-loader/lib??vue-loader-options!./ReuseVarDialog.vue?vue&type=script&lang=js& */630),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);e.default=n.a},630:
/*!***********************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/template/TemplateEdit/ReuseVarDialog.vue?vue&type=script&lang=js& ***!
  \***********************************************************************************************************************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=c(a(/*! babel-runtime/helpers/extends */131));a(/*! @/utils/i18n.js */14);var n=a(/*! vuex */42),o=a(/*! vee-validate */198),s=a(/*! @/constants/index.js */502),r=c(a(/*! @/components/common/base/BaseCheckbox.vue */515)),l=c(a(/*! @/components/common/base/BaseInput.vue */509));function c(t){return t&&t.__esModule?t:{default:t}}e.default={name:"ReuseVarDialog",components:{BaseCheckbox:r.default,BaseInput:l.default},props:["isReuseVarDialogShow","reuseVariable","reuseableVarList"],data:function(){return{i18n:{reuse:gettext("复用变量"),new:gettext("新建变量"),name:gettext("变量名称"),key:gettext("变量KEY")},selectedVar:this.reuseVariable.useNewKey?"":this.reuseableVarList[0].id,isCreateVar:this.reuseVariable.useNewKey,varName:"",varKey:"",variableNameRule:{required:!0,max:20,regex:s.NAME_REG},variableKeyRule:{required:!0,max:20,regex:/(^\$\{\w+\}$)|(^\w+$)/,keyRepeat:!0}}},computed:(0,i.default)({},(0,n.mapState)({constants:function(t){return t.template.constants}}),{isSelectDisabled:function(){return this.isCreateVar},title:function(){return this.reuseVariable.useNewKey?gettext("变量KEY已存在，请创建新变量"):gettext("是否复用变量")}}),created:function(){var t=this;this.validator=new o.Validator({}),this.validator.extend("keyRepeat",function(e){return!((e=/^\$\{\w+\}$/.test(e)?e:"${"+e+"}")in t.constants)})},methods:{onSelect:function(t){this.selectedVar=t},onToggleCreateVar:function(t){this.isCreateVar=t},onConfirm:function(t){var e=this;this.$nextTick(function(){e.$validator.validateAll().then(function(t){if(t||!e.isCreateVar){var a=void 0;e.isCreateVar?(/^\$\{[\w]*\}$/.test(e.varKey)||(e.varKey="${"+e.varKey+"}"),a={type:"create",name:e.varName,key:e.reuseVariable.key,varKey:e.varKey,source_tag:e.reuseVariable.source_tag,source_info:e.reuseVariable.source_info,value:e.reuseVariable.value}):a={type:"reuse",name:e.reuseVariable.name,key:e.reuseVariable.key,varKey:e.selectedVar,source_tag:e.reuseVariable.source_tag,source_info:e.reuseVariable.source_info,value:e.reuseVariable.value},e.$emit("onConfirmReuseVar",a)}})})},onCancel:function(){this.$emit("onCancelReuseVar",this.reuseVariable)}}}},631:
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/lib!./node_modules/sass-loader/lib/loader.js!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/template/TemplateEdit/ReuseVarDialog.vue?vue&type=style&index=0&id=f1e310e8&lang=scss&scoped=true& ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/*! exports used: default */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,a){},632:
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/lib!./node_modules/sass-loader/lib/loader.js!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/template/TemplateEdit/NodeConfig.vue?vue&type=style&index=0&id=341d12fb&lang=scss&scoped=true& ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/*! exports used: default */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,a){},633:
/*!**************************************************************************************!*\
  !*** ./src/pages/template/TemplateEdit/GlobalVariables.vue?vue&type=script&lang=js& ***!
  \**************************************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(t,e,a){"use strict";a.r(e);var i=a(/*! -!../../../../node_modules/babel-loader/lib!../../../../node_modules/vue-loader/lib??vue-loader-options!./GlobalVariables.vue?vue&type=script&lang=js& */634),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);e.default=n.a},634:
/*!************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/template/TemplateEdit/GlobalVariables.vue?vue&type=script&lang=js& ***!
  \************************************************************************************************************************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=u(a(/*! babel-runtime/helpers/extends */131));a(/*! @/utils/i18n.js */14);var n=a(/*! vuex */42),o=u(a(/*! @/utils/tools.js */196)),s=u(a(/*! vuedraggable */475)),r=u(a(/*! @/components/common/base/BaseCheckbox.vue */515)),l=u(a(/*! @/components/common/base/BaseInput.vue */509)),c=u(a(/*! ./VariableEdit.vue */808));function u(t){return t&&t.__esModule?t:{default:t}}u(a(/*! @/utils/draft.js */578)),e.default={name:"GlobalVariables",components:{BaseInput:l.default,BaseCheckbox:r.default,VariableEdit:c.default,draggable:s.default},props:["businessInfoLoading","isTemplateConfigValid","isSettingPanelShow","draftArray"],data:function(){return{i18n:{global_varibles:gettext("全局变量"),new:gettext("新建变量"),source:gettext("来源："),two_types:gettext("分两种，输入类型"),outputs_type:gettext("或输出类型"),desc:gettext("。输入类型变量来自用户添加的变量或者原子/子流程节点输入参数引用的变量；输出类型变量来自原子/子流程节点输出参数引用的变量。"),show:gettext("显示："),show_desc:gettext("表示该变量在创建任务填写参数时是否展示给用户，输出类型的变量一定是隐藏的。"),outputs:gettext("输出："),outputs_desc:gettext("表示该变量会作为该流程模板的输出参数，在被其他流程模板当做子流程节点时可以引用。"),name:gettext("名称"),source2:gettext("来源"),hide:gettext("隐藏"),show2:gettext("显示"),delete:gettext("变量删除"),inputs:gettext("输入"),outputs2:gettext("输出"),varHook:gettext("勾选变量作为流程输出参数"),varCancelHook:gettext("取消勾选"),common:gettext("基础属性"),type:gettext("分类"),notify_type:gettext("通知方式"),timeout:gettext("超时时长"),receiver_group:gettext("通知分组"),tips:gettext("删除变量"),confirm:gettext("确认删除该变量？"),categoryTip:gettext("必填项"),copied:gettext("已复制"),draft:gettext("草稿箱"),newDraft:gettext("新建草稿"),draftMessage:gettext("草稿名称"),replace:gettext("替换"),saveTime:gettext("保存时间"),replaceTips:gettext("替换流程"),replaceConfirm:gettext("是否使用草稿替换当前流程？"),serialNumber:gettext("序号"),draftName:gettext("草稿名称"),sketch:gettext("简述："),draftSketch:gettext("草稿可以用于记录当前流程所有信息，包括流程的节点编排、全局变量、名称、基础属性等信息。草稿箱支持每个流程最多保存50个最近的草稿，该数据存储至本地浏览器的 localStorage 中，每个用户只能查看和编辑自己的草稿。"),produce:gettext("生成方式："),draftProduce:gettext("分四种：自动保存，用户自动编排，用户新建草稿，用户切换草稿。"),draftProduce1:gettext("自动保存：用户在编辑流程时，每5分钟会自动保存一次。"),draftProduce2:gettext('用户自动编排：用户使用画布"自动编排"功能时，会自动把编排前的流程信息保存成草稿。'),draftProduce3:gettext("用户新建草稿：用户可以随时把编辑中的流程保存成草稿，并自定义名称。"),draftProduce4:gettext("用户切换草稿：用户使用草稿还原数据时，会把还原前的流程信息保存成草稿。"),deleteMethod:gettext("删除："),draftDelete:gettext("分两种：单个删除，全部删除。"),draftDelete1:gettext("单个删除：用户在编辑流程时，可以在草稿箱中选择某个草稿点击删除按钮进行删除。"),draftDelete2:gettext("全部删除：用户可以通过清除浏览器 localStorage 数据来删除所有流程的所有草稿，该操作不可复原，需慎重。")},showPanel:!0,isVariableEditing:!1,theKeyOfEditing:"",constantsArray:[],selectedTaskCategory:"",activeTab:"global-variable-tab",deleteVarKey:"",deleteVarIndex:"",deleteConfirmDialogShow:!1,copyText:"",replaceConfirmDialogShow:!1,replaceData:null,newConfirmDialogShow:!1,newDraftName:"",draftIsError:!1,newDraftErrorMessage:""}},computed:(0,i.default)({},(0,n.mapState)({businessBaseInfo:function(t){return t.template.businessBaseInfo},outputs:function(t){return t.template.outputs},constants:function(t){return t.template.constants},timeout:function(t){return t.template.time_out}}),{variableData:function(){return this.theKeyOfEditing?this.constants[this.theKeyOfEditing]:{custom_type:"input",desc:"",key:"",name:"",show_type:"show",source_info:{},source_tag:"",source_type:"custom",validation:"^.+$",validator:[],value:""}},notifyGroup:function(){return this.businessBaseInfo.notify_group?this.businessBaseInfo.notify_group.map(function(t){return{id:t.value,name:t.text}}):[]},notifyTypeList:function(){return this.businessBaseInfo.notify_type_list?this.businessBaseInfo.notify_type_list.map(function(t){return{id:t.value,name:t.name}}):[]},taskCategories:function(){return this.businessBaseInfo.task_categories?this.businessBaseInfo.task_categories.map(function(t){return{id:t.value,name:t.name}}):[]},receiverGroup:{get:function(){return this.$store.state.template.notify_receivers.receiver_group},set:function(t){this.setReceiversGroup(t)}},notifyType:{get:function(){return this.$store.state.template.notify_type},set:function(t){this.setNotifyType(t)}},category:{get:function(){return this.$store.state.template.category},set:function(t){this.setCategory(t),this.$emit("onSelectCategory",t)}}}),watch:{constants:{handler:function(){this.theKeyOfEditing="",this.isVariableEditing=!1,this.constantsArray=this.getConstantsArray()},deep:!0},isTemplateConfigValid:function(t){t||(this.activeTab="template-config-tab")},isSettingPanelShow:function(t){this.showPanel=t}},created:function(){this.constantsArray=this.getConstantsArray()},methods:(0,i.default)({},(0,n.mapMutations)("template/",["editVariable","deleteVariable","setOutputs","setReceiversGroup","setNotifyType","setOvertime","setCategory"]),{getConstantsArray:function(){var t=[];for(var e in this.constants){var a=o.default.deepClone(this.constants[e]);t.push(a)}return t.sort(function(t,e){return t.index-e.index})},togglePanel:function(){this.$emit("toggleSettingPanel",!this.showPanel)},updateVariableIndex:function(t,e){var a=this;this.constantsArray.slice(t,e).forEach(function(t,e){t.index=e,a.editVariable({key:t.key,variable:t})})},onTabChange:function(t){this.activeTab=t},onAddVariable:function(){this.isVariableEditing=!0,this.theKeyOfEditing="",this.$emit("varibleDataChanged")},onEditVariable:function(t){this.isVariableEditing=!0,this.theKeyOfEditing=t,this.$emit("varibleDataChanged")},onDeleteVariable:function(t,e){this.deleteVarKey=t,this.deleteVarIndex=e,this.deleteConfirmDialogShow=!0},onChangeEdit:function(t){this.isVariableEditing=t},onChangeVariableOutput:function(t,e){var a=e?"add":"delete";this.setOutputs({changeType:a,key:t}),this.$emit("varibleDataChanged")},onDragEnd:function(t){var e=this,a=t.newIndex,i=t.oldIndex,n=Math.min(a,i),o=Math.max(a,i)+1;this.constantsArray.slice(n,o).forEach(function(t,a){t.index=a+n,e.editVariable({key:t.key,variable:t})}),this.$emit("varibleDataChanged")},onChangeTimeout:function(t){this.setOvertime(t)},onChangeTaskCategories:function(t){this.selectedTaskCategory=t},onConfirm:function(){var t=this,e=this.deleteVarKey,a=this.deleteVarIndex;this.$emit("onDeleteConstant",e);var i=this.constantsArray.length;i>1&&this.constantsArray.slice(a+1,i).forEach(function(e,a){e.index-=1,t.editVariable({key:e.key,variable:e})}),this.deleteVariable(e),this.$emit("varibleDataChanged"),this.deleteConfirmDialogShow=!1},onCancel:function(){this.deleteConfirmDialogShow=!1},onReplaceTemplate:function(t){this.replaceConfirmDialogShow=!0,this.replaceData=t},onDeleteDraft:function(t){this.$emit("onDeleteDraft",t)},onReplaceConfirm:function(){this.$emit("onReplaceTemplate",this.replaceData),this.replaceConfirmDialogShow=!1},onReplaceCancel:function(){this.replaceConfirmDialogShow=!1},onNewDraftTemplate:function(){this.newConfirmDialogShow=!0},onNewConfirm:function(){this.draftIsError||(this.draftIsError=!1,this.$emit("onNewDraft",this.newDraftName),this.newDraftName="",this.newConfirmDialogShow=!1)},onNewCancel:function(){this.newDraftName="",this.newConfirmDialogShow=!1},checkDraftName:function(){this.newDraftName.length>10?(this.draftIsError=!0,this.newDraftErrorMessage=gettext("草稿名称不能超过10个字符")):0===this.newDraftName.length?(this.draftIsError=!0,this.newDraftErrorMessage=gettext("草稿名称不能为空")):this.draftIsError=!1}})}},635:
/*!***********************************************************************************!*\
  !*** ./src/pages/template/TemplateEdit/VariableEdit.vue?vue&type=script&lang=js& ***!
  \***********************************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(t,e,a){"use strict";a.r(e);var i=a(/*! -!../../../../node_modules/babel-loader/lib!../../../../node_modules/vue-loader/lib??vue-loader-options!./VariableEdit.vue?vue&type=script&lang=js& */636),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);e.default=n.a},636:
/*!*********************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/template/TemplateEdit/VariableEdit.vue?vue&type=script&lang=js& ***!
  \*********************************************************************************************************************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var i=g(a(/*! babel-runtime/core-js/object/assign */32)),n=g(a(/*! babel-runtime/core-js/object/keys */85)),o=g(a(/*! babel-runtime/regenerator */132)),s=g(a(/*! babel-runtime/helpers/asyncToGenerator */133)),r=g(a(/*! babel-runtime/helpers/extends */131));a(/*! @/utils/i18n.js */14);var l=a(/*! vuex */42),c=a(/*! vee-validate */198),u=a(/*! @/constants/index.js */502),d=a(/*! @/utils/errorHandler.js */134),f=g(a(/*! @/utils/tools.js */196)),m=g(a(/*! @/utils/atomFilter.js */534)),h=(a(/*! @/utils/checkDataType.js */135),g(a(/*! @/components/common/RenderFormNew/RenderForm.vue */514))),p=g(a(/*! @/components/common/base/BaseInput.vue */509)),v=g(a(/*! ./VariableEditDialog.vue */809));function g(t){return t&&t.__esModule?t:{default:t}}var b={ip:"var_ip_picker.ip_picker",password:"password.password",select:"select.select"},C={select:"select_meta"},_=[{id:"input",name:gettext("输入框")},{id:"textarea",name:gettext("文本框")},{id:"datetime",name:gettext("日期时间")},{id:"int",name:gettext("整数")},{id:"ip",name:gettext("IP选择器")},{id:"password",name:gettext("密码")},{id:"select",name:gettext("下拉框")}],y=[{id:"show",name:gettext("显示")},{id:"hide",name:gettext("隐藏")}];e.default={name:"VariableEdit",components:{RenderForm:h.default,VariableEditDialog:v.default,BaseInput:p.default},props:["variableData","isNewVariable"],data:function(){var t=f.default.deepClone(this.variableData),e="value"in t?{customVariable:t.value}:{};return{i18n:{name:gettext("名称"),desc:gettext("说明"),default:gettext("默认值"),meta:gettext("配置"),edit_table:gettext("编辑表格"),validation:gettext("校验规则"),type:gettext("类型"),show:gettext("显示"),save:gettext("保存"),cancel:gettext("取消")},atomConfigLoading:!1,bkMessageInstance:null,showTypeList:[].concat(y),theEditingData:t,renderData:e,renderConfig:[],renderOption:{showHook:!1,showGroup:!1,showLabel:!1},isEditDialogShow:!1,variableNameRule:{required:!0,max:20,regex:u.NAME_REG},variableKeyRule:{required:!0,max:20,regex:/(^\$\{\w+\}$)|(^\w+$)/,keyRepeat:!0},defaultValueRule:{required:"hide"===t.show_type,customValueCheck:!0},validationRule:{validReg:!0}}},computed:(0,r.default)({},(0,l.mapState)({atomFormConfig:function(t){return t.atomForm.config},constants:function(t){return t.template.constants}}),{isShowDefault:function(){var t=this.theEditingData;return t.custom_type,"component_outputs"!==t.source_type},isRenderAtomForm:function(){var t=this.theEditingData,e=t.custom_type;return"component_inputs"===t.source_type&&!e||e in b},isDisabledValType:function(){var t=this.theEditingData.source_type;return"component_inputs"===t||"component_outputs"===t},isDisabledShowType:function(){return"component_outputs"===this.theEditingData.source_type},currentValType:{get:function(){return this.isDisabledValType?"component":this.theEditingData.custom_type},set:function(t){this.theEditingData.custom_type=t}},valTypeList:function(){return this.isDisabledValType?[{id:"component",name:gettext("组件")}]:[].concat(_)},atomType:function(){var t=this.theEditingData,e=t.custom_type,a=(t.source_type,t.source_tag);return a?a.split(".")[0]:e in b?b[e].split(".")[0]:""}}),watch:{variableData:{handler:function(t){this.theEditingData=f.default.deepClone(t)},deep:!0},"theEditingData.show_type":function(t){this.defaultValueRule="hide"===t?{required:!0,customValueCheck:!0}:{customValueCheck:!0}}},created:function(){var t=this;this.validator=new c.Validator({}),this.validator.extend("keyRepeat",function(e){return e=/^\$\{\w+\}$/.test(e)?e:"${"+e+"}",t.variableData.key===e||!(e in t.constants)}),this.validator.extend("validReg",function(t){try{new RegExp(t)}catch(t){return console.error(t),!1}return!0}),this.validator.extend("customValueCheck",function(e){try{return!!new RegExp(t.theEditingData.validation).test(e)}catch(t){return console.error(t),!1}})},mounted:function(){this.isRenderAtomForm?this.getAtomConfig():this.getRenderConfig()},methods:(0,r.default)({},(0,l.mapMutations)("atomForm/",["setAtomConfig"]),(0,l.mapActions)("atomForm/",["loadAtomConfig"]),(0,l.mapMutations)("template/",["addVariable","editVariable","deleteVariable"]),{getAtomConfig:function(){var e=this;return(0,s.default)(o.default.mark(function a(){var i,n;return o.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(i=C[e.atomType]||e.atomType,n=C[e.atomType]?1:0,!t.atoms[i]){a.next=5;break}return e.getRenderConfig(),a.abrupt("return");case 5:return e.atomConfigLoading=!0,a.prev=6,a.next=9,e.loadAtomConfig({atomType:e.atomType,isMeta:n});case 9:e.setAtomConfig({atomType:i,configData:t.atoms[i]}),e.getRenderConfig(),a.next=16;break;case 13:a.prev=13,a.t0=a.catch(6),(0,d.errorHandler)(a.t0,e);case 16:return a.prev=16,e.atomConfigLoading=!1,a.finish(16);case 19:case"end":return a.stop()}},a,e,[[6,13,16,19]])}))()},getRenderConfig:function(){var t=this.theEditingData,e=t.source_tag,a=t.custom_type,i=C[this.atomType]||this.atomType,n=this.atomFormConfig[i],o=void 0;if(this.isRenderAtomForm)if(!n||!this.isRenderAtomForm||a in b)(o=f.default.deepClone(n[0])).tag_code="customVariable";else{var s=e.split(".")[1];(o=f.default.deepClone(m.default.formFilter(s,n))).tag_code="customVariable"}else o={tag_code:"customVariable",type:a,attrs:{}},"input"===a&&(o.attrs.validation=[],"hide"===this.theEditingData.show_type&&o.attrs.validation.push({type:"required"}),o.attrs.validation.push({type:"regex",args:this.theEditingData.validation,error_message:gettext("默认值不满足校验规则")}));this.renderConfig=[o]},onValTypeChange:function(t,e){this.renderData={},this.theEditingData.validation="input"===t?"^.+$":"",b[this.theEditingData.custom_type]?this.theEditingData.source_tag=b[this.theEditingData.custom_type]:this.theEditingData.source_tag="",C[this.theEditingData.custom_type]?this.theEditingData.is_meta=!0:this.theEditingData.is_meta=!1,b[t]?this.getAtomConfig():this.getRenderConfig()},onValShowTypeChange:function(t,e){this.theEditingData.show_type=t,this.getRenderConfig()},onBlurValidation:function(){this.getRenderConfig()},onShowEditDialog:function(){this.isEditDialogShow=!0},onConfirmDialogEdit:function(t){this.isEditDialogShow=!1,this.theEditingData.value=t.customVariable},onCancelDialogEdit:function(){this.isEditDialogShow=!1},saveEdit:function(){var t=this;this.$validator.validateAll().then(function(e){var a=!0;if(t.$refs.renderForm&&(a=!t.value&&"show"===t.theEditingData.show_type||t.$refs.renderForm.validate()),e&&a){var o=t.theEditingData;/^\$\{\w+\}$/.test(o.key)||(o.key="${"+o.key+"}"),t.$emit("onChangeEdit",!1),t.theEditingData.value=t.renderData.customVariable,t.isNewVariable?(o.index=(0,n.default)(t.constants).length,t.addVariable((0,i.default)(o))):t.editVariable({key:t.variableData.key,variable:o})}})},cancelEdit:function(){this.$emit("onChangeEdit",!1)}})}}).call(this,a(/*! jquery */24))},637:
/*!*****************************************************************************************!*\
  !*** ./src/pages/template/TemplateEdit/VariableEditDialog.vue?vue&type=script&lang=js& ***!
  \*****************************************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(t,e,a){"use strict";a.r(e);var i=a(/*! -!../../../../node_modules/babel-loader/lib!../../../../node_modules/vue-loader/lib??vue-loader-options!./VariableEditDialog.vue?vue&type=script&lang=js& */638),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);e.default=n.a},638:
/*!***************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/template/TemplateEdit/VariableEditDialog.vue?vue&type=script&lang=js& ***!
  \***************************************************************************************************************************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),a(/*! @/utils/i18n.js */14);var i=o(a(/*! @/utils/tools.js */196)),n=o(a(/*! @/components/common/RenderFormNew/RenderForm.vue */514));function o(t){return t&&t.__esModule?t:{default:t}}e.default={name:"VariableEditDialog",components:{RenderForm:n.default},props:["isShow","renderConfig","renderData","renderOption"],data:function(){return{i18n:{edit:gettext("编辑变量")},formData:i.default.deepClone(this.renderData)}},methods:{onConfirm:function(){var t=!0;this.$refs.renderForm&&(t=this.$refs.renderForm.validate()),t&&this.$emit("onConfirmDialogEdit",this.formData)},onCancel:function(){this.$emit("onCancelDialogEdit")}}}},639:
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/lib!./node_modules/sass-loader/lib/loader.js!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/template/TemplateEdit/VariableEditDialog.vue?vue&type=style&index=0&id=378ec87b&lang=scss&scoped=true& ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/*! exports used: default */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,a){},640:
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/lib!./node_modules/sass-loader/lib/loader.js!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/template/TemplateEdit/VariableEdit.vue?vue&type=style&index=0&id=6a7ea753&lang=scss&scoped=true& ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/*! exports used: default */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,a){},641:
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/lib!./node_modules/sass-loader/lib/loader.js!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/template/TemplateEdit/GlobalVariables.vue?vue&type=style&index=0&id=1250c9b5&lang=scss&scoped=true& ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/*! exports used: default */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,a){},642:
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/lib!./node_modules/sass-loader/lib/loader.js!./node_modules/vue-loader/lib??vue-loader-options!./src/pages/template/TemplateEdit/index.vue?vue&type=style&index=0&id=060da313&lang=scss&scoped=true& ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/*! exports used: default */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,a){},774:
/*!********************************************************!*\
  !*** ./src/pages/template/TemplateEdit/NodeConfig.vue ***!
  \********************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(t,e,a){"use strict";a.r(e);var i=a(/*! ./NodeConfig.vue?vue&type=template&id=341d12fb&scoped=true& */881),n=a(/*! ./NodeConfig.vue?vue&type=script&lang=js& */580);for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);a(/*! ./NodeConfig.vue?vue&type=style&index=0&id=341d12fb&lang=scss&scoped=true& */806);var s=a(/*! ../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js */2),r=Object(s.a)(n.default,i.a,i.b,!1,null,"341d12fb",null);r.options.__file="NodeConfig.vue",e.default=r.exports},804:
/*!************************************************************!*\
  !*** ./src/pages/template/TemplateEdit/ReuseVarDialog.vue ***!
  \************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(t,e,a){"use strict";a.r(e);var i=a(/*! ./ReuseVarDialog.vue?vue&type=template&id=f1e310e8&scoped=true& */905),n=a(/*! ./ReuseVarDialog.vue?vue&type=script&lang=js& */629);for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);a(/*! ./ReuseVarDialog.vue?vue&type=style&index=0&id=f1e310e8&lang=scss&scoped=true& */805);var s=a(/*! ../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js */2),r=Object(s.a)(n.default,i.a,i.b,!1,null,"f1e310e8",null);r.options.__file="ReuseVarDialog.vue",e.default=r.exports},805:
/*!**********************************************************************************************************************!*\
  !*** ./src/pages/template/TemplateEdit/ReuseVarDialog.vue?vue&type=style&index=0&id=f1e310e8&lang=scss&scoped=true& ***!
  \**********************************************************************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module exports are unknown */function(t,e,a){"use strict";var i=a(/*! -!../../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../../node_modules/css-loader!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/lib!../../../../node_modules/sass-loader/lib/loader.js!../../../../node_modules/vue-loader/lib??vue-loader-options!./ReuseVarDialog.vue?vue&type=style&index=0&id=f1e310e8&lang=scss&scoped=true& */631);a.n(i).a},806:
/*!******************************************************************************************************************!*\
  !*** ./src/pages/template/TemplateEdit/NodeConfig.vue?vue&type=style&index=0&id=341d12fb&lang=scss&scoped=true& ***!
  \******************************************************************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module exports are unknown */function(t,e,a){"use strict";var i=a(/*! -!../../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../../node_modules/css-loader!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/lib!../../../../node_modules/sass-loader/lib/loader.js!../../../../node_modules/vue-loader/lib??vue-loader-options!./NodeConfig.vue?vue&type=style&index=0&id=341d12fb&lang=scss&scoped=true& */632);a.n(i).a},807:
/*!*************************************************************!*\
  !*** ./src/pages/template/TemplateEdit/GlobalVariables.vue ***!
  \*************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(t,e,a){"use strict";a.r(e);var i=a(/*! ./GlobalVariables.vue?vue&type=template&id=1250c9b5&scoped=true& */893),n=a(/*! ./GlobalVariables.vue?vue&type=script&lang=js& */633);for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);a(/*! ./GlobalVariables.vue?vue&type=style&index=0&id=1250c9b5&lang=scss&scoped=true& */812);var s=a(/*! ../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js */2),r=Object(s.a)(n.default,i.a,i.b,!1,null,"1250c9b5",null);r.options.__file="GlobalVariables.vue",e.default=r.exports},808:
/*!**********************************************************!*\
  !*** ./src/pages/template/TemplateEdit/VariableEdit.vue ***!
  \**********************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(t,e,a){"use strict";a.r(e);var i=a(/*! ./VariableEdit.vue?vue&type=template&id=6a7ea753&scoped=true& */902),n=a(/*! ./VariableEdit.vue?vue&type=script&lang=js& */635);for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);a(/*! ./VariableEdit.vue?vue&type=style&index=0&id=6a7ea753&lang=scss&scoped=true& */811);var s=a(/*! ../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js */2),r=Object(s.a)(n.default,i.a,i.b,!1,null,"6a7ea753",null);r.options.__file="VariableEdit.vue",e.default=r.exports},809:
/*!****************************************************************!*\
  !*** ./src/pages/template/TemplateEdit/VariableEditDialog.vue ***!
  \****************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module exports are unknown */function(t,e,a){"use strict";a.r(e);var i=a(/*! ./VariableEditDialog.vue?vue&type=template&id=378ec87b&scoped=true& */911),n=a(/*! ./VariableEditDialog.vue?vue&type=script&lang=js& */637);for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);a(/*! ./VariableEditDialog.vue?vue&type=style&index=0&id=378ec87b&lang=scss&scoped=true& */810);var s=a(/*! ../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js */2),r=Object(s.a)(n.default,i.a,i.b,!1,null,"378ec87b",null);r.options.__file="VariableEditDialog.vue",e.default=r.exports},810:
/*!**************************************************************************************************************************!*\
  !*** ./src/pages/template/TemplateEdit/VariableEditDialog.vue?vue&type=style&index=0&id=378ec87b&lang=scss&scoped=true& ***!
  \**************************************************************************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module exports are unknown */function(t,e,a){"use strict";var i=a(/*! -!../../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../../node_modules/css-loader!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/lib!../../../../node_modules/sass-loader/lib/loader.js!../../../../node_modules/vue-loader/lib??vue-loader-options!./VariableEditDialog.vue?vue&type=style&index=0&id=378ec87b&lang=scss&scoped=true& */639);a.n(i).a},811:
/*!********************************************************************************************************************!*\
  !*** ./src/pages/template/TemplateEdit/VariableEdit.vue?vue&type=style&index=0&id=6a7ea753&lang=scss&scoped=true& ***!
  \********************************************************************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module exports are unknown */function(t,e,a){"use strict";var i=a(/*! -!../../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../../node_modules/css-loader!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/lib!../../../../node_modules/sass-loader/lib/loader.js!../../../../node_modules/vue-loader/lib??vue-loader-options!./VariableEdit.vue?vue&type=style&index=0&id=6a7ea753&lang=scss&scoped=true& */640);a.n(i).a},812:
/*!***********************************************************************************************************************!*\
  !*** ./src/pages/template/TemplateEdit/GlobalVariables.vue?vue&type=style&index=0&id=1250c9b5&lang=scss&scoped=true& ***!
  \***********************************************************************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module exports are unknown */function(t,e,a){"use strict";var i=a(/*! -!../../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../../node_modules/css-loader!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/lib!../../../../node_modules/sass-loader/lib/loader.js!../../../../node_modules/vue-loader/lib??vue-loader-options!./GlobalVariables.vue?vue&type=style&index=0&id=1250c9b5&lang=scss&scoped=true& */641);a.n(i).a},813:
/*!*************************************************************************************************************!*\
  !*** ./src/pages/template/TemplateEdit/index.vue?vue&type=style&index=0&id=060da313&lang=scss&scoped=true& ***!
  \*************************************************************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module exports are unknown */function(t,e,a){"use strict";var i=a(/*! -!../../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../../node_modules/css-loader!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/lib!../../../../node_modules/sass-loader/lib/loader.js!../../../../node_modules/vue-loader/lib??vue-loader-options!./index.vue?vue&type=style&index=0&id=060da313&lang=scss&scoped=true& */642);a.n(i).a},877:
/*!**********************************************************************************************************!*\
  !*** ./src/pages/template/TemplateEdit/index.vue?vue&type=template&id=060da313&scoped=true& + 1 modules ***!
  \**********************************************************************************************************/
/*! exports provided: render, staticRenderFns */
/*! exports used: render, staticRenderFns */function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.templateDataLoading},expression:"{isLoading: templateDataLoading}"}],staticClass:"template-page"},[t.templateDataLoading||t.exception.code?t._e():a("div",{staticClass:"pipeline-canvas-wrapper"},[a("PipelineCanvas",{ref:"pipelineCanvas",attrs:{singleAtomListLoading:t.singleAtomListLoading,subAtomListLoading:t.subAtomListLoading,canvasData:t.canvasData,name:t.name,cc_id:t.cc_id,atomTypeList:t.atomTypeList,searchAtomResult:t.searchAtomResult},on:{onChangeName:t.onChangeName,onSaveTemplate:t.onSaveTemplate,onSearchAtom:t.onSearchAtom,onBackToList:t.onBackToList,onNodeClick:t.onNodeClick,onLabelBlur:t.onLabelBlur,onLocationChange:t.onLocationChange,onLineChange:t.onLineChange,onLocationMoveDone:t.onLocationMoveDone,onNewDraft:t.onNewDraft,onReplaceLineAndLocation:t.onReplaceLineAndLocation}}),t._v(" "),t.isNodeConfigPanelShow?a("NodeConfig",{ref:"nodeConfig",attrs:{template_id:t.template_id,singleAtom:t.singleAtom,subAtom:t.subAtom,isSettingPanelShow:t.isSettingPanelShow,isNodeConfigPanelShow:t.isNodeConfigPanelShow,idOfNodeInConfigPanel:t.idOfNodeInConfigPanel},on:{hideConfigPanel:t.hideConfigPanel,onUpdateNodeInfo:t.onUpdateNodeInfo}}):t._e(),t._v(" "),a("GlobalVariables",{attrs:{draftArray:t.draftArray,businessInfoLoading:t.businessInfoLoading,isTemplateConfigValid:t.isTemplateConfigValid,isSettingPanelShow:t.isSettingPanelShow},on:{toggleSettingPanel:t.toggleSettingPanel,onDeleteConstant:t.onDeleteConstant,varibleDataChanged:t.varibleDataChanged,onSelectCategory:t.onSelectCategory,onDeleteDraft:t.onDeleteDraft,onReplaceTemplate:t.onReplaceTemplate,onNewDraft:t.onNewDraft}}),t._v(" "),a("bk-dialog",{attrs:{"is-show":t.isLeaveDialogShow,"quick-close":!1,"ext-cls":"common-dialog",title:t.i18n.leave,width:"400",padding:"30px"},on:{"update:isShow":function(e){t.isLeaveDialogShow=e},confirm:t.onLeaveConfirm,cancel:t.onLeaveCancel}},[a("div",{attrs:{slot:"content"},slot:"content"},[t._v(t._s(t.i18n.tips))])])],1)])},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},881:
/*!***************************************************************************************************************!*\
  !*** ./src/pages/template/TemplateEdit/NodeConfig.vue?vue&type=template&id=341d12fb&scoped=true& + 1 modules ***!
  \***************************************************************************************************************/
/*! exports provided: render, staticRenderFns */
/*! exports used: render, staticRenderFns */function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"node-config"},[a("div",{class:{"node-config-panel":!0,"position-right-side":!t.isSettingPanelShow}},[a("div",{staticClass:"basic-info"},[a("h3",{staticClass:"common-section-title"},[t._v(t._s(t.i18n.base_info))]),t._v(" "),a("div",{staticClass:"section-form basic-info-form"},[a("div",{staticClass:"form-item form-name"},[a("label",{staticClass:"required"},[t._v(t._s(t.atomNameType))]),t._v(" "),a("div",{staticClass:"form-content"},[a("bk-selector",{attrs:{searchable:!0,list:t.atomList,selected:t.currentAtom},on:{"item-selected":t.onAtomSelect}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.taskTypeEmpty,expression:"taskTypeEmpty"}],staticClass:"common-error-tip error-msg"},[t._v(t._s(t.atomNameType+t.i18n.typeEmptyTip))])],1),t._v(" "),t.atomDesc?a("bk-tooltip",{staticClass:"desc-tooltip",attrs:{placement:"left",width:"400"}},[a("i",{staticClass:"common-icon-warning atom-desc"}),t._v(" "),a("div",{staticStyle:{"white-space":"normal"},attrs:{slot:"content"},slot:"content"},[a("div",[t._v(t._s(t.atomDesc))])])]):t._e(),t._v(" "),t.subflowHasUpdate?a("i",{directives:[{name:"bktooltips",rawName:"v-bktooltips",value:{content:t.i18n.update,placements:["left"]},expression:"{content: i18n.update, placements: ['left']}"}],staticClass:"common-icon-task update-tooltip",on:{click:t.onUpdateSubflowVersion}}):t._e()],1),t._v(" "),a("div",{staticClass:"form-item"},[a("label",{staticClass:"required"},[t._v(t._s(t.i18n.node_name))]),t._v(" "),a("div",{staticClass:"form-content"},[a("BaseInput",{directives:[{name:"validate",rawName:"v-validate",value:t.nodeNameRule,expression:"nodeNameRule"}],attrs:{name:"nodeName"},model:{value:t.nodeName,callback:function(e){t.nodeName=e},expression:"nodeName"}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("nodeName"),expression:"errors.has('nodeName')"}],staticClass:"common-error-tip error-msg"},[t._v(t._s(t.errors.first("nodeName")))])],1)]),t._v(" "),a("div",{staticClass:"form-item"},[a("label",[t._v(t._s(t.i18n.stage_tag))]),t._v(" "),a("div",{staticClass:"form-content"},[a("BaseInput",{directives:[{name:"validate",rawName:"v-validate",value:t.stageNameRule,expression:"stageNameRule"}],attrs:{name:"stageName"},model:{value:t.stageName,callback:function(e){t.stageName=e},expression:"stageName"}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("stageName"),expression:"errors.has('stageName')"}],staticClass:"common-error-tip error-msg"},[t._v(t._s(t.errors.first("stageName")))])],1)]),t._v(" "),this.isSingleAtom?a("div",{staticClass:"form-item"},[a("label",[t._v(t._s(t.i18n.ignore))]),t._v(" "),a("div",{staticClass:"form-content"},[a("bk-switcher",{attrs:{selected:t.errorCouldBeIgnored,"is-square":!0},on:{change:t.onErrorIngoredChange}})],1)]):t._e(),t._v(" "),a("div",{staticClass:"form-item"},[a("label",[t._v(t._s(t.i18n.optional))]),t._v(" "),a("div",{staticClass:"form-content"},[a("bk-switcher",{attrs:{selected:t.nodeCouldBeSkipped,"is-square":!0},on:{change:t.onSkippedChange}})],1)])])]),t._v(" "),a("div",{staticClass:"inputs-info"},[a("h3",{staticClass:"common-section-title"},[t._v(t._s(t.i18n.input))]),t._v(" "),a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.atomConfigLoading,opacity:1},expression:"{isLoading: atomConfigLoading, opacity: 1}"}],staticClass:"section-form inputs-info-form"},[!t.atomConfigLoading&&t.renderInputConfig&&t.renderInputConfig.length?a("RenderForm",{ref:"renderForm",attrs:{scheme:t.renderInputConfig,formData:t.renderInputData.value,formOption:t.renderInputOption,hooked:t.renderInputData.hook},on:{change:t.onInputDataChange,onHookChange:t.onInputHookChange}}):a("div",{staticClass:"no-data-wrapper"},[a("NoData")],1)],1)]),t._v(" "),a("div",{staticClass:"outputs-info"},[a("h3",{staticClass:"common-section-title"},[t._v(t._s(t.i18n.output))]),t._v(" "),a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.atomConfigLoading,opacity:1},expression:"{isLoading: atomConfigLoading, opacity: 1}"}],staticClass:"section-form outputs-info-form"},[t.renderOutputData&&t.renderOutputData.length?a("table",{staticClass:"outputs-table"},[a("thead",[a("tr",[a("th",{staticClass:"output-name"},[t._v(t._s(t.i18n.name))]),t._v(" "),a("th",{staticClass:"output-key"},[t._v("KEY")]),t._v(" "),a("th",{staticClass:"output-checkbox"},[t._v(t._s(t.i18n.refer))])])]),t._v(" "),a("tbody",t._l(t.renderOutputData,function(e){return a("tr",{key:e.key},[a("td",{staticClass:"output-name"},[t._v(t._s(e.name))]),t._v(" "),a("td",{staticClass:"output-key"},[t._v(t._s(e.key))]),t._v(" "),a("td",{staticClass:"output-checkbox"},[a("bk-tooltip",{attrs:{content:e.hook?t.i18n.cancelHook:t.i18n.hook,placement:"left"}},[a("BaseCheckbox",{attrs:{isChecked:e.hook},on:{checkCallback:function(a){t.onOutputHookChange(e.name,e.key,a)}}})],1)],1)])}))]):a("div",{staticClass:"no-data-wrapper"},[a("NoData")],1)])])]),t._v(" "),t.isReuseVarDialogShow?a("ReuseVarDialog",{attrs:{isReuseVarDialogShow:t.isReuseVarDialogShow,reuseVariable:t.reuseVariable,reuseableVarList:t.reuseableVarList},on:{onConfirmReuseVar:t.onConfirmReuseVar,onCancelReuseVar:t.onCancelReuseVar}}):t._e()],1)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},893:
/*!********************************************************************************************************************!*\
  !*** ./src/pages/template/TemplateEdit/GlobalVariables.vue?vue&type=template&id=1250c9b5&scoped=true& + 1 modules ***!
  \********************************************************************************************************************/
/*! exports provided: render, staticRenderFns */
/*! exports used: render, staticRenderFns */function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:["setting-panel",{actived:this.showPanel}]},[a("div",{staticClass:"toggle-button",on:{click:t.togglePanel}},[a("i",{class:["common-icon-arrow-left",{"arrow-right":this.showPanel}]})]),t._v(" "),a("bk-tab",{staticClass:"panel-content",attrs:{"active-name":t.activeTab},on:{"tab-changed":t.onTabChange}},[a("bk-tabpanel",{attrs:{name:"global-variable-tab",title:t.i18n.global_varibles}},[a("div",{staticClass:"add-variable"},[a("bk-button",{attrs:{type:"primary"},on:{click:t.onAddVariable}},[t._v(t._s(t.i18n.new))]),t._v(" "),a("bk-tooltip",{staticClass:"globle-variable-tootip",attrs:{placement:"bottom-end"}},[a("i",{staticClass:"common-icon-warning"}),t._v(" "),a("div",{attrs:{slot:"content"},slot:"content"},[a("div",{staticClass:"tips-item",staticStyle:{"white-space":"normal"}},[a("h4",[t._v(t._s(t.i18n.source))]),t._v(" "),a("p",[t._v("\n                                "+t._s(t.i18n.two_types)+"\n                                "),a("span",{staticClass:"common-icon-source-out"}),t._v(" "+t._s(t.i18n.outputs_type)+"\n                                "),a("span",{staticClass:"common-icon-source-in"}),t._v(" "+t._s(t.i18n.desc)+"\n                            ")])]),t._v(" "),a("div",{staticClass:"tips-item"},[a("h4",[t._v(t._s(t.i18n.show))]),t._v(" "),a("p",[t._v(t._s(t.i18n.show_desc))])]),t._v(" "),a("div",{staticClass:"tips-item"},[a("h4",[t._v(t._s(t.i18n.outputs))]),t._v(" "),a("p",[t._v(t._s(t.i18n.outputs_desc))])])])])],1),t._v(" "),a("div",{staticClass:"global-variable-content"},[a("div",{staticClass:"variable-header clearfix"},[a("span",{staticClass:"col-drag t-head"}),t._v(" "),a("span",{staticClass:"col-name t-head"},[t._v(t._s(t.i18n.name))]),t._v(" "),a("span",{staticClass:"col-key t-head"},[t._v("KEY")]),t._v(" "),a("span",{staticClass:"col-source t-head"},[t._v(t._s(t.i18n.source2))]),t._v(" "),a("span",{staticClass:"col-show-type t-head"},[t._v(t._s(t.i18n.show2))]),t._v(" "),a("span",{staticClass:"col-delete t-head"},[t._v(t._s(t.i18n.delete))]),t._v(" "),a("span",{staticClass:"col-output t-head"},[t._v(t._s(t.i18n.outputs2))])]),t._v(" "),a("ul",{staticClass:"variable-list"},[a("draggable",{attrs:{options:{handle:".col-drag"}},on:{end:t.onDragEnd},model:{value:t.constantsArray,callback:function(e){t.constantsArray=e},expression:"constantsArray"}},t._l(t.constantsArray,function(e,i){return a("li",{key:e.key,class:{clearfix:!0,"variable-item":!0,"variable-editing":t.isVariableEditing&&t.theKeyOfEditing===e.key},on:{click:function(a){t.onEditVariable(e.key)}}},[a("div",{staticClass:"variable-content"},[a("span",{staticClass:"col-item col-drag"},[a("i",{staticClass:"common-icon-drag"})]),t._v(" "),a("span",{staticClass:"col-item col-name"},[t._v("\n                                        "+t._s(e.name)+"\n                                    ")]),t._v(" "),a("span",{staticClass:"col-item col-key"},[t._v(t._s(e.key))]),t._v(" "),a("span",{staticClass:"col-item col-source"},[a("i",{directives:[{name:"bktooltips",rawName:"v-bktooltips.bottom",value:"component_outputs"!==e.source_type?t.i18n.inputs:t.i18n.outputs2,expression:"constant.source_type !== 'component_outputs' ? i18n.inputs : i18n.outputs2",modifiers:{bottom:!0}}],class:"component_outputs"!==e.source_type?"common-icon-source-in":"common-icon-source-out"})]),t._v(" "),a("span",{staticClass:"col-item col-show-type"},[a("i",{directives:[{name:"bktooltips",rawName:"v-bktooltips.bottom",value:"show"===e.show_type?t.i18n.show2:t.i18n.hide,expression:"constant.show_type === 'show' ? i18n.show2 : i18n.hide",modifiers:{bottom:!0}}],class:"show"===e.show_type?"common-icon-eye-open":"common-icon-eye-close"})]),t._v(" "),a("span",{staticClass:"col-item col-delete",on:{click:function(a){a.stopPropagation(),t.onDeleteVariable(e.key,i)}}},[a("i",{staticClass:"common-icon-close"})]),t._v(" "),a("span",{staticClass:"col-item col-output"},[a("BaseCheckbox",{directives:[{name:"bktooltips",rawName:"v-bktooltips.left",value:t.outputs.indexOf(e.key)>-1?t.i18n.varCancelHook:t.i18n.varHook,expression:"outputs.indexOf(constant.key) > -1 ? i18n.varCancelHook : i18n.varHook",modifiers:{left:!0}}],attrs:{isChecked:t.outputs.indexOf(e.key)>-1},on:{checkCallback:function(a){t.onChangeVariableOutput(e.key,a)}}})],1)]),t._v(" "),t.isVariableEditing&&t.theKeyOfEditing===e.key?a("div",{key:e.key+"-edit"},[a("VariableEdit",{attrs:{variableData:t.variableData,isNewVariable:!1},on:{onChangeEdit:t.onChangeEdit}})],1):t._e()])})),t._v(" "),t.isVariableEditing&&""===t.theKeyOfEditing?a("li",[a("VariableEdit",{attrs:{variableData:t.variableData,isNewVariable:!0},on:{onChangeEdit:t.onChangeEdit}})],1):t._e()],1)])]),t._v(" "),a("bk-tabpanel",{attrs:{name:"template-config-tab",title:t.i18n.common}},[a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.businessInfoLoading,opacity:1},expression:"{isLoading: businessInfoLoading, opacity: 1}"}],staticClass:"config-wrapper"},[a("div",{staticClass:"common-form-item"},[a("label",[t._v(t._s(t.i18n.type))]),t._v(" "),a("div",{staticClass:"common-form-content"},[a("bk-selector",{attrs:{list:t.taskCategories,selected:t.category},on:{"update:selected":function(e){t.category=e},"item-selected":t.onChangeTaskCategories}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:!t.isTemplateConfigValid,expression:"!isTemplateConfigValid"}],staticClass:"common-error-tip error-msg"},[t._v(t._s(t.i18n.categoryTip))])],1)]),t._v(" "),a("div",{staticClass:"common-form-item"},[a("label",[t._v(t._s(t.i18n.notify_type))]),t._v(" "),a("div",{staticClass:"common-form-content"},[a("el-checkbox-group",{model:{value:t.notifyType,callback:function(e){t.notifyType=e},expression:"notifyType"}},t._l(t.notifyTypeList,function(e){return a("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.name))])}))],1)]),t._v(" "),a("div",{staticClass:"common-form-item"},[a("label",[t._v(t._s(t.i18n.receiver_group))]),t._v(" "),a("div",{staticClass:"common-form-content"},[a("el-checkbox-group",{model:{value:t.receiverGroup,callback:function(e){t.receiverGroup=e},expression:"receiverGroup"}},t._l(t.notifyGroup,function(e){return a("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.name))])}))],1)])])])],1),t._v(" "),a("bk-dialog",{attrs:{"is-show":t.deleteConfirmDialogShow,"quick-close":!1,"ext-cls":"common-dialog",title:t.i18n.tips,width:"400",padding:"30px"},on:{"update:isShow":function(e){t.deleteConfirmDialogShow=e},confirm:t.onConfirm,cancel:t.onCancel}},[a("div",{attrs:{slot:"content"},slot:"content"},[t._v(t._s(t.i18n.confirm))])]),t._v(" "),a("bk-dialog",{attrs:{"is-show":t.replaceConfirmDialogShow,"quick-close":!1,"ext-cls":"common-dialog",title:t.i18n.replaceTips,width:"400",padding:"30px"},on:{"update:isShow":function(e){t.replaceConfirmDialogShow=e},confirm:t.onReplaceConfirm,cancel:t.onReplaceCancel}},[a("div",{attrs:{slot:"content"},slot:"content"},[t._v(t._s(t.i18n.replaceConfirm))])]),t._v(" "),a("bk-dialog",{attrs:{"is-show":t.newConfirmDialogShow,"quick-close":!1,"ext-cls":"common-dialog",title:t.i18n.newDraft,width:"400",padding:"30px"},on:{"update:isShow":function(e){t.newConfirmDialogShow=e},confirm:t.onNewConfirm,cancel:t.onNewCancel}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("div",{staticClass:"common-form-item",attrs:{id:"draft-dialog-content"}},[a("label",{staticClass:"required"},[t._v(t._s(t.i18n.draftName))]),t._v(" "),a("div",{staticClass:"common-form-content"},[a("BaseInput",{on:{input:t.checkDraftName},model:{value:t.newDraftName,callback:function(e){t.newDraftName=e},expression:"newDraftName"}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.draftIsError,expression:"draftIsError"}],staticClass:"common-error-tip error-msg"},[t._v(t._s(t.newDraftErrorMessage))])],1)])])])],1)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},902:
/*!*****************************************************************************************************************!*\
  !*** ./src/pages/template/TemplateEdit/VariableEdit.vue?vue&type=template&id=6a7ea753&scoped=true& + 1 modules ***!
  \*****************************************************************************************************************/
/*! exports provided: render, staticRenderFns */
/*! exports used: render, staticRenderFns */function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"variable-edit-wrapper"},[a("ul",{staticClass:"form-list"},[a("li",{staticClass:"form-item clearfix"},[a("label",{staticClass:"form-label"},[t._v(t._s(t.i18n.name))]),t._v(" "),a("div",{staticClass:"form-content"},[a("BaseInput",{directives:[{name:"validate",rawName:"v-validate",value:t.variableNameRule,expression:"variableNameRule"}],attrs:{type:"text",name:"variableName"},model:{value:t.theEditingData.name,callback:function(e){t.$set(t.theEditingData,"name",e)},expression:"theEditingData.name"}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("variableName"),expression:"errors.has('variableName')"}],staticClass:"common-error-tip error-msg"},[t._v(t._s(t.errors.first("variableName")))])],1)]),t._v(" "),a("li",{staticClass:"form-item clearfix"},[a("label",{staticClass:"form-label"},[t._v("KEY")]),t._v(" "),a("div",{staticClass:"form-content"},[a("BaseInput",{directives:[{name:"validate",rawName:"v-validate",value:t.variableKeyRule,expression:"variableKeyRule"}],attrs:{type:"text",name:"variableKey",disabled:t.isDisabledValType},model:{value:t.theEditingData.key,callback:function(e){t.$set(t.theEditingData,"key",e)},expression:"theEditingData.key"}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("variableKey"),expression:"errors.has('variableKey')"}],staticClass:"common-error-tip error-msg"},[t._v(t._s(t.errors.first("variableKey")))])],1)]),t._v(" "),a("li",{staticClass:"form-item clearfix"},[a("label",{staticClass:"form-label"},[t._v(t._s(t.i18n.desc))]),t._v(" "),a("div",{staticClass:"form-content"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.theEditingData.desc,expression:"theEditingData.desc"}],domProps:{value:t.theEditingData.desc},on:{input:function(e){e.target.composing||t.$set(t.theEditingData,"desc",e.target.value)}}})])]),t._v(" "),a("li",{staticClass:"form-item clearfix"},[a("label",{staticClass:"form-label"},[t._v(t._s(t.i18n.type))]),t._v(" "),a("div",{staticClass:"form-content"},[a("bk-selector",{attrs:{list:t.valTypeList,selected:t.currentValType,disabled:this.isDisabledValType},on:{"update:selected":function(e){t.currentValType=e},"item-selected":t.onValTypeChange}})],1)]),t._v(" "),a("li",{directives:[{name:"show",rawName:"v-show",value:t.isShowDefault,expression:"isShowDefault"}],staticClass:"form-item clearfix"},[a("label",{staticClass:"form-label"},[t._v(t._s(t.theEditingData.is_meta?t.i18n.meta:t.i18n.default))]),t._v(" "),a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.atomConfigLoading,opacity:1},expression:"{isLoading: atomConfigLoading, opacity: 1}"}],staticClass:"form-content"},[!t.atomConfigLoading&&t.renderConfig.length?[t.renderConfig[0].type&&"datatable"!==t.renderConfig[0].type?a("RenderForm",{ref:"renderForm",attrs:{scheme:t.renderConfig,formOption:t.renderOption},model:{value:t.renderData,callback:function(e){t.renderData=e},expression:"renderData"}}):a("a",{staticClass:"edit-table",on:{click:t.onShowEditDialog}},[t._v("\n                        "+t._s(t.i18n.edit_table)+"\n                    ")])]:t._e()],2)]),t._v(" "),"input"===t.theEditingData.custom_type?a("li",{staticClass:"form-item clearfix"},[a("label",{staticClass:"form-label"},[t._v(t._s(t.i18n.validation))]),t._v(" "),a("div",{staticClass:"form-content"},[a("el-input",{directives:[{name:"validate",rawName:"v-validate",value:t.validationRule,expression:"validationRule"}],attrs:{name:"valueValidation"},on:{blur:t.onBlurValidation},model:{value:t.theEditingData.validation,callback:function(e){t.$set(t.theEditingData,"validation",e)},expression:"theEditingData.validation"}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("valueValidation"),expression:"errors.has('valueValidation')"}],staticClass:"common-error-tip error-msg"},[t._v(t._s(t.errors.first("valueValidation")))])],1)]):t._e(),t._v(" "),a("li",{staticClass:"form-item clearfix"},[a("label",{staticClass:"form-label"},[t._v(t._s(t.i18n.show))]),t._v(" "),a("div",{staticClass:"form-content"},[a("bk-selector",{attrs:{list:t.showTypeList,selected:t.theEditingData.show_type,disabled:this.isDisabledShowType},on:{"update:selected":function(e){t.$set(t.theEditingData,"show_type",e)},"item-selected":t.onValShowTypeChange}})],1)])]),t._v(" "),a("div",{staticClass:"action-wrapper"},[a("bk-button",{staticClass:"common-green-btn",attrs:{type:"success"},on:{click:function(e){return e.stopPropagation(),t.saveEdit(e)}}},[t._v(t._s(t.i18n.save))]),t._v(" "),a("bk-button",{staticClass:"common-default-btn",attrs:{type:"default"},on:{click:function(e){return e.stopPropagation(),t.cancelEdit(e)}}},[t._v(t._s(t.i18n.cancel))])],1),t._v(" "),t.isEditDialogShow?a("VariableEditDialog",{attrs:{isShow:t.isEditDialogShow,renderConfig:t.renderConfig,renderOption:t.renderOption,renderData:t.renderData},on:{onConfirmDialogEdit:t.onConfirmDialogEdit,onCancelDialogEdit:t.onCancelDialogEdit}}):t._e()],1)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},905:
/*!*******************************************************************************************************************!*\
  !*** ./src/pages/template/TemplateEdit/ReuseVarDialog.vue?vue&type=template&id=f1e310e8&scoped=true& + 1 modules ***!
  \*******************************************************************************************************************/
/*! exports provided: render, staticRenderFns */
/*! exports used: render, staticRenderFns */function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("bk-dialog",{attrs:{"is-show":t.isReuseVarDialogShow,"quick-close":!1,"ext-cls":"common-dialog",title:t.title,width:"600"},on:{"update:isShow":function(e){t.isReuseVarDialogShow=e},confirm:function(e){t.onConfirm(e)},cancel:t.onCancel}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("div",{staticClass:"reuse-variable-dialog"},[t.reuseVariable.useNewKey?t._e():a("div",{staticClass:"common-form-item"},[a("label",[t._v(t._s(t.i18n.reuse))]),t._v(" "),a("div",{staticClass:"common-form-content"},[a("bk-selector",{attrs:{list:t.reuseableVarList,selected:t.selectedVar,disabled:t.isSelectDisabled},on:{"update:selected":function(e){t.selectedVar=e},"item-selected":t.onSelect}})],1)]),t._v(" "),t.reuseVariable.useNewKey?t._e():a("div",{staticClass:"common-form-item"},[a("label",[t._v(t._s(t.i18n.new))]),t._v(" "),a("div",{staticClass:"common-form-content"},[a("div",{staticClass:"new_variable-checkbox"},[a("BaseCheckbox",{on:{checkCallback:t.onToggleCreateVar}})],1)])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isCreateVar,expression:"isCreateVar"}],staticClass:"create-new-variable"},[a("div",{staticClass:"common-form-item"},[a("label",[t._v(t._s(t.i18n.name))]),t._v(" "),a("div",{staticClass:"common-form-content"},[a("BaseInput",{directives:[{name:"validate",rawName:"v-validate",value:t.variableNameRule,expression:"variableNameRule"}],attrs:{name:"variableName"},model:{value:t.varName,callback:function(e){t.varName=e},expression:"varName"}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("variableName"),expression:"errors.has('variableName')"}],staticClass:"common-error-tip error-msg"},[t._v(t._s(t.errors.first("variableName")))])],1)]),t._v(" "),a("div",{staticClass:"common-form-item clearfix"},[a("label",[t._v(t._s(t.i18n.key))]),t._v(" "),a("div",{staticClass:"common-form-content"},[a("BaseInput",{directives:[{name:"validate",rawName:"v-validate",value:t.variableKeyRule,expression:"variableKeyRule"}],attrs:{name:"variableKey"},model:{value:t.varKey,callback:function(e){t.varKey=e},expression:"varKey"}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("variableKey"),expression:"errors.has('variableKey')"}],staticClass:"common-error-tip error-msg"},[t._v(t._s(t.errors.first("variableKey")))])],1)])])])])])},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},911:
/*!***********************************************************************************************************************!*\
  !*** ./src/pages/template/TemplateEdit/VariableEditDialog.vue?vue&type=template&id=378ec87b&scoped=true& + 1 modules ***!
  \***********************************************************************************************************************/
/*! exports provided: render, staticRenderFns */
/*! exports used: render, staticRenderFns */function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"edit-dialog-wrapper"},[a("bk-dialog",{attrs:{"quick-close":!1,"ext-cls":"common-dialog",title:t.i18n.edit,width:"600","is-show":t.isShow},on:{"update:isShow":function(e){t.isShow=e},confirm:t.onConfirm,cancel:t.onCancel}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("RenderForm",{ref:"renderForm",attrs:{scheme:t.renderConfig,formOption:t.renderOption},model:{value:t.formData,callback:function(e){t.formData=e},expression:"formData"}})],1)])],1)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})}}]);
//# sourceMappingURL=6.js.map